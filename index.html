<!DOCTYPE html>
<html lang="en" >
<head>
  	<meta charset="UTF-8">
	<title>Send Message</title>
	<link rel='stylesheet' href='https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.9.0/css/all.min.css'>
	<link rel="stylesheet" href="./style.css">
	<script src="https://cdnjs.cloudflare.com/ajax/libs/prefixfree/1.0.7/prefixfree.min.js"></script>
	<script type="text/javascript">
		let channels = [
			{
				name: "#update-log",
				url: "https://discord.com/api/webhooks/794238549959639090/mSZiIoLM7xrU0epG7pb-HIc-b7glpkgASfee_HZBTX-gOn1tTQd5j6vBlOEWKsNefibd"
			},
			{
				name: "#thong-bao",
				url: "https://discordapp.com/api/webhooks/794401054003429416/-4aWsray0fKRJ0tBLo-vfITsi8iu-7QiwctxFhlfX1yFJUNmMoTRTg7vll6-INTE77xN"
			},
			{
				name: "RL #thong-bao",
				url: "https://discord.com/api/webhooks/883172286620926033/6dVQW6GHuKdfPH6iJp6dwtBS_9Dne-Xo5LsW6Us8PqMwtj2iEnDV9JiM2kqj24EdNpFd"
			}
		];
		let url = "";

	</script>

</head>
<body>
<div class="container">
	<form>
		<div class="field" tabindex="1">
			<label for="username">
				<i class="fas fa-user"></i>Bot Name
			</label>
			<input name="username" id="username" type="text" placeholder="e.g. john the bot" required>
		</div>
		<div class="field" tabindex="2">
			<label for="channel">
				<i class="fas fa-user"></i>Chat Channel
			</label>
			<input name="channel" id="channel" type="text" placeholder="select form button below" readonly required>
		</div>
		<div id="channel-select">
		</div>
		<div class="field" tabindex="3">
			<label for="color">
				<i class="fas fa-user"></i>Hex Color
			</label>
			<input name="color" id="color" type="color" placeholder="#ffffff" required>
		</div>
		<div class="field" tabindex="4">
			<label for="author_name">
				<i class="fas fa-user"></i>Author Name
			</label>
			<input name="author_name" id="author_name" type="text" placeholder="e.g. john doe" required>
		</div>
		<div class="field" tabindex="5">
			<label for="title">
				<i class="fas fa-pen"></i>Title
			</label>
			<input name="title" id="title" type="text" placeholder="e.g. Update 1.1" required>
		</div>
		<div class="field" tabindex="6">
			<label for="description">
				<i class="fas fa-edit"></i>Description
			</label>
			<textarea name="description" id="description" placeholder="type here" required></textarea>
		</div>
		<button class="button" type="button" onclick="sendUpdate()">Send Message</button>
	</form>

<script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
        crossorigin="anonymous"></script>		
<script>
    function sendUpdate() {
        let username = $("#username").val();
        let author_name = $("#author_name").val();
        let title = $("#title").val();
        let description = $("#description").val();
        let channel = $("#channel").val();
        let hex_color = $("#color").val();

        let request = new XMLHttpRequest();
        request.open("POST", channel);
        request.setRequestHeader('Content-type', 'application/json');

        let myEmbed = {
            author: {
                name: author_name
            },
            title: title,
            description: description,
            color: hexToDecimal(hex_color),
        }

        let params = {
            username: username,
            embeds: [ myEmbed ]
        }

        request.send(JSON.stringify(params));
        resetForm();
    }
    function hexToDecimal(hex) {
        return parseInt(hex.replace("#",""), 16)
    }
    function resetForm(){
        $("#username").val("");
        $("#author_name").val("");
        $("#title").val("");
        $("#description").val("");
        $("#channel").val("");
    }
    function setChannel(val){
        $("#channel").val(val);
    }
    $( document ).ready(function() {
		channels.forEach((channel)=>{
    		$("#channel-select").
    		append(
    			"<button type=\"button\"" +
    			"onclick=\"setChannel('"+ channel.url + "')\">" + 
    			channel.name + 
    			"</button>")
		})
	});
	</script>
</body>
</html>
